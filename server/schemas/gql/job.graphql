# Job - Generic async job system for long-running operations

enum JobType {
  IMPORT
  # Future: EXPORT, BULK_UPDATE, etc.
}

enum JobStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  CANCELLED
}

type Job implements Node {
  id: ID!
  type: JobType!
  projectId: ID!
  status: JobStatus!
  progress: JobProgress!
  error: String
  createdAt: DateTime!
  updatedAt: DateTime!
  startedAt: DateTime
  completedAt: DateTime
}

type JobProgress {
  processed: Int!
  total: Int!
  percentage: Float!
}

type JobState {
  status: JobStatus!
  progress: JobProgress  # nullable - only present when status is IN_PROGRESS
  error: String          # only present when status is FAILED
}

# Query extensions
extend type Query {
  job(jobId: ID!): Job
  jobs(projectId: ID!, type: JobType, status: JobStatus): [Job!]!
}

# Mutation extensions
extend type Mutation {
  cancelJob(jobId: ID!): Job
}

# Subscription extensions
extend type Subscription {
  jobState(jobId: ID!): JobState!
}
